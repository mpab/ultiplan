#!/bin/sh

[ -z "$ULTIPLAN_HOME" ] && echo "ERROR: ULTIPLAN_HOME is not set" && exit

startYarnProcess() {
    if [ ! -z $(uname | grep MINGW64) ]; then
    mintty sh -mc "yarn start &>/dev/null < /dev/null &"
    else
    sh -mc "yarn start &>/dev/null < /dev/null &"
    fi
}

ultiplanProject=$PWD
if [ ! -z $(uname | grep MINGW64) ]; then
  echo windows OS detected
  ultiplanProject=$(cmd.exe /c cd)
fi

cd $ULTIPLAN_HOME/api
cp env .env
echo "ultiplanProject=$ultiplanProject" >> .env
startYarnProcess
cd $ULTIPLAN_HOME/ui
startYarnProcess

# TODO: implement check to see if API & UI are running
# ping -n 5 localhost
# curl http://localhost:3001/api 
# curl http://localhost:3000
